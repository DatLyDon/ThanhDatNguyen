<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thi·∫øt k·∫ø h·ªôp qu√† 5 m·∫∑t</title>
    <style>
        :root {
            --primary-color: #e74c3c;
            --secondary-color: #f9f3f3;
        }
        body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 20px;
            background-color: var(--secondary-color);
        }
        .selection-page {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        .design-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-top: 40px;
        }
        .design-option {
            background: white;
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            cursor: pointer;
            transition: transform 0.3s;
        }
        .design-option:hover {
            transform: translateY(-5px);
        }
        .design-option img {
            width: 100%;
            height: 200px;
            object-fit: cover;
            border-radius: 10px;
            margin-bottom: 15px;
        }
        .template-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        .template {
            background: white;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: transform 0.3s;
        }
        .template:hover {
            transform: scale(1.05);
        }
        .template img {
            width: 100%;
            height: 150px;
            object-fit: cover;
            border-radius: 8px;
            margin-bottom: 10px;
        }
        .back-button {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            margin-bottom: 20px;
            font-size: 16px;
        }
        .main-content {
            display: none;
        }
        .template-page {
            display: none;
        }
        .container {
            display: flex;
            gap: 30px;
            max-width: 1400px;
            margin: 0 auto;
            flex-wrap: wrap;
        }
        .design-panel {
            flex: 1;
            min-width: 400px;
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        .preview-panel {
            flex: 1;
            min-width: 400px;
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        h1 {
            color: var(--primary-color);
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.5em;
        }
        .tab-container {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 1px solid #ddd;
        }
        .tab {
            padding: 10px 20px;
            cursor: pointer;
            background: #f1f1f1;
            border-radius: 5px 5px 0 0;
            margin-right: 5px;
        }
        .tab.active {
            background: var(--primary-color);
            color: white;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        .form-group {
            margin-bottom: 20px;
        }
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #333;
        }
        input, select, textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 16px;
        }
        textarea {
            height: 80px;
            resize: vertical;
        }
        button {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 18px;
            transition: background 0.3s;
            width: 100%;
            margin-top: 10px;
        }
        button:hover {
            background-color: #c0392b;
        }
        #net-preview {
            width: 100%;
            height: 450px;
            background-color: #f9f9f9;
            position: relative;
            margin: 20px 0;
            border: 1px dashed #ccc;
        }
        .box-face {
            position: absolute;
            border: 1px solid #999;
            display: flex;
            align-items: center;
            justify-content: center;
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            width: 120px;
            height: 120px;
            background-color: rgba(255,255,255,0.8);
            overflow: hidden;
        }
        .face-text {
            padding: 10px;
            text-align: center;
            word-break: break-word;
            color: white;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.8);
            font-weight: bold;
            display: none;
        }
        #box-3d-preview {
            width: 300px;
            height: 300px;
            margin: 20px auto;
            position: relative;
            transform-style: preserve-3d;
            transform: rotateX(-20deg) rotateY(-30deg);
            cursor: grab;
            transition: transform 0.1s;
        }
        #box-3d-preview:active {
            cursor: grabbing;
        }
        .face-3d {
            position: absolute;
            width: 200px;
            height: 200px;
            opacity: 0.9;
            border: 2px solid rgba(255,255,255,0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            color: white;
            text-shadow: 0 0 5px #000;
            backface-visibility: visible;
            background-size: cover;
            background-position: center;
        }
        .image-controls {
            display: none;
        }
        .preview-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        .preview-tab {
            padding: 10px 20px;
            background: #f1f1f1;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s ease;
        }
        .preview-tab.active {
            background: var(--primary-color);
            color: white;
        }
        .preview-content {
            display: none;
        }
        .preview-content.active {
            display: block;
        }
        .view-toggle {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        .view-btn {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 8px;
            background: #f1f1f1;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s ease;
        }
        .view-btn.active {
            background: var(--primary-color);
            color: white;
        }
        .view-content {
            margin: 20px 0;
        }
        .material-icon {
            width: 20px;
            height: 20px;
            display: inline-block;
            margin-right: 8px;
            vertical-align: middle;
            border-radius: 50%;
        }
        .paper { background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); }
        .fabric { background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); }
        .wood { background: linear-gradient(135deg, #e6b980 0%, #eacda3 100%); }
        .size-inputs {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-top: 10px;
        }
        
        .size-input {
            display: flex;
            flex-direction: column;
        }
        
        .size-input input {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }
        
        .size-input label {
            font-size: 12px;
            margin-bottom: 4px;
        }

        /* Image Editor Modal */
        .image-editor-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
        }

        .image-editor-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 20px;
            border-radius: 10px;
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
        }

        .image-preview-container {
            position: relative;
            width: 100%;
            height: 400px;
            border: 2px dashed #ddd;
            margin-bottom: 20px;
            overflow: hidden;
        }

        .image-preview {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            max-width: 100%;
            max-height: 100%;
            cursor: move;
        }

        .image-editor-controls {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-bottom: 20px;
        }

        .control-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .control-group label {
            font-size: 14px;
            color: #666;
        }

        .control-group input[type="range"] {
            width: 100%;
        }

        .editor-buttons {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }

        .editor-buttons button {
            width: auto;
            padding: 10px 20px;
        }

        .cancel-btn {
            background-color: #95a5a6;
        }

        .cancel-btn:hover {
            background-color: #7f8c8d;
        }

        .face::after {
            display: none; /* ·∫®n c√°c nh√£n m·∫∑t */
        }

        .face.top::after,
        .face.front::after,
        .face.back::after,
        .face.left::after,
        .face.right::after {
            content: none; /* X√≥a n·ªôi dung c·ªßa c√°c nh√£n */
        }

        /* X√≥a c√°c ƒëo·∫°n CSS ƒë·ªãnh nghƒ©a n·ªôi dung cho t·ª´ng m·∫∑t */
        .face.top::after { content: none; }
        .face.front::after { content: none; }
        .face.back::after { content: none; }
        .face.left::after { content: none; }
        .face.right::after { content: none; }

        .face-3d::after {
            content: attr(data-face);
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 12px;
            color: rgba(0, 0, 0, 0.6);
            background: rgba(255, 255, 255, 0.8);
            padding: 2px 6px;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <div class="selection-page" id="selection-page">
        <h1>üéÅ Thi·∫øt k·∫ø h·ªôp qu√† 5 m·∫∑t</h1>
        <div class="design-options">
            <div class="design-option" onclick="showTemplates()">
                <img src="https://example.com/template-preview.jpg" alt="M·∫´u thi·∫øt k·∫ø s·∫µn">
                <h2>Ch·ªçn m·∫´u thi·∫øt k·∫ø s·∫µn</h2>
                <p>L·ª±a ch·ªçn t·ª´ c√°c m·∫´u thi·∫øt k·∫ø ƒë·∫πp, chuy√™n nghi·ªáp</p>
            </div>
            <div class="design-option" onclick="showCustomDesign()">
                <img src="https://example.com/custom-preview.jpg" alt="Thi·∫øt k·∫ø t√πy ch·ªânh">
                <h2>T·ª± thi·∫øt k·∫ø</h2>
                <p>T·∫°o thi·∫øt k·∫ø ƒë·ªôc ƒë√°o theo √Ω th√≠ch c·ªßa b·∫°n</p>
            </div>
        </div>
    </div>

    <div class="template-page" id="template-page">
        <button class="back-button" onclick="showSelectionPage()">‚Üê Quay l·∫°i</button>
        <h1>Ch·ªçn m·∫´u thi·∫øt k·∫ø</h1>
        <div class="template-grid">
            <div class="template" onclick="selectTemplate(1)">
                <img src="https://example.com/template1.jpg" alt="M·∫´u 1">
                <h3>M·∫´u sinh nh·∫≠t</h3>
            </div>
            <div class="template" onclick="selectTemplate(2)">
                <img src="https://example.com/template2.jpg" alt="M·∫´u 2">
                <h3>M·∫´u t√¨nh y√™u</h3>
            </div>
            <div class="template" onclick="selectTemplate(3)">
                <img src="https://example.com/template3.jpg" alt="M·∫´u 3">
                <h3>M·∫´u Gi√°ng sinh</h3>
            </div>
            <div class="template" onclick="selectTemplate(4)">
                <img src="https://example.com/template4.jpg" alt="M·∫´u 4">
                <h3>M·∫´u nƒÉm m·ªõi</h3>
            </div>
            <div class="template" onclick="selectTemplate(5)">
                <img src="https://example.com/template5.jpg" alt="M·∫´u 5">
                <h3>M·∫´u ch√∫c m·ª´ng</h3>
            </div>
        </div>
    </div>

    <div class="main-content" id="main-content">
        <button class="back-button" onclick="showSelectionPage()">‚Üê Quay l·∫°i</button>
        <div class="container">
            <div class="design-panel">
                <div class="tab-container">
                    <div class="tab active" data-tab="top">M·∫∑t tr√™n</div>
                    <div class="tab" data-tab="front">M·∫∑t tr∆∞·ªõc</div>
                    <div class="tab" data-tab="back">M·∫∑t sau</div>
                    <div class="tab" data-tab="left">M·∫∑t tr√°i</div>
                    <div class="tab" data-tab="right">M·∫∑t ph·∫£i</div>
                </div>

                <div id="top-tab" class="tab-content active">
                    <div class="form-group">
                        <label for="top-image">H√¨nh ·∫£nh m·∫∑t tr√™n</label>
                        <input type="file" id="top-image" accept="image/*" class="face-image">
                    </div>
                </div>

                <div id="front-tab" class="tab-content">
                    <div class="form-group">
                        <label for="front-image">H√¨nh ·∫£nh m·∫∑t tr∆∞·ªõc</label>
                        <input type="file" id="front-image" accept="image/*" class="face-image">
                    </div>
                </div>

                <div id="back-tab" class="tab-content">
                    <div class="form-group">
                        <label for="back-image">H√¨nh ·∫£nh m·∫∑t sau</label>
                        <input type="file" id="back-image" accept="image/*" class="face-image">
                    </div>
                </div>

                <div id="left-tab" class="tab-content">
                    <div class="form-group">
                        <label for="left-image">H√¨nh ·∫£nh m·∫∑t tr√°i</label>
                        <input type="file" id="left-image" accept="image/*" class="face-image">
                    </div>
                </div>

                <div id="right-tab" class="tab-content">
                    <div class="form-group">
                        <label for="right-image">H√¨nh ·∫£nh m·∫∑t ph·∫£i</label>
                        <input type="file" id="right-image" accept="image/*" class="face-image">
                    </div>
                </div>

                <div class="form-group">
                    <label for="box-material">Ch·∫•t li·ªáu h·ªôp</label>
                    <select id="box-material">
                        <option value="paper"><span class="material-icon paper"></span> Gi·∫•y</option>
                        <option value="fabric"><span class="material-icon fabric"></span> V·∫£i</option>
                        <option value="wood"><span class="material-icon wood"></span> G·ªó</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="box-size">K√≠ch th∆∞·ªõc h·ªôp</label>
                    <select id="box-size" onchange="toggleCustomSize()">
                        <option value="small">Nh·ªè (10x10x10 cm)</option>
                        <option value="medium" selected>V·ª´a (15x15x15 cm)</option>
                        <option value="large">L·ªõn (20x20x20 cm)</option>
                        <option value="custom">T√πy ch·ªânh</option>
                    </select>
                </div>

                <div id="custom-size" class="form-group" style="display: none;">
                    <div class="size-inputs">
                        <div class="size-input">
                            <label for="box-width">Chi·ªÅu r·ªông (cm)</label>
                            <input type="number" id="box-width" min="5" max="50" value="15">
                        </div>
                        <div class="size-input">
                            <label for="box-height">Chi·ªÅu cao (cm)</label>
                            <input type="number" id="box-height" min="5" max="50" value="15">
                        </div>
                        <div class="size-input">
                            <label for="box-depth">Chi·ªÅu s√¢u (cm)</label>
                            <input type="number" id="box-depth" min="5" max="50" value="15">
                        </div>
                    </div>
                </div>

                <button id="update-btn">C·∫≠p nh·∫≠t thi·∫øt k·∫ø</button>
            </div>

            <div class="preview-panel">
                <div id="3d-view" class="view-content">
                    <div id="box-3d-preview">
                        <div class="face-3d" id="top-3d" data-face="M·∫∑t tr√™n" style="transform: rotateX(90deg) translateZ(100px)"></div>
                        <div class="face-3d" id="front-3d" data-face="M·∫∑t tr∆∞·ªõc" style="transform: translateZ(100px)"></div>
                        <div class="face-3d" id="back-3d" data-face="M·∫∑t sau" style="transform: rotateY(180deg) translateZ(100px)"></div>
                        <div class="face-3d" id="left-3d" data-face="M·∫∑t tr√°i" style="transform: rotateY(-90deg) translateZ(100px)"></div>
                        <div class="face-3d" id="right-3d" data-face="M·∫∑t ph·∫£i" style="transform: rotateY(90deg) translateZ(100px)"></div>
                    </div>
                </div>

                <button id="save-btn">üíæ L∆∞u thi·∫øt k·∫ø</button>
            </div>
        </div>
    </div>

    <!-- Image Editor Modal -->
    <div class="image-editor-modal" id="image-editor-modal">
        <div class="image-editor-content">
            <h2>ƒêi·ªÅu ch·ªânh h√¨nh ·∫£nh</h2>
            <div class="image-preview-container">
                <img src="" alt="Preview" class="image-preview" id="image-preview">
            </div>
            <div class="image-editor-controls">
                <div class="control-group">
                    <label>V·ªã tr√≠ X</label>
                    <input type="range" id="position-x" min="-100" max="100" value="0">
                    <label>V·ªã tr√≠ Y</label>
                    <input type="range" id="position-y" min="-100" max="100" value="0">
                </div>
                <div class="control-group">
                    <label>K√≠ch th∆∞·ªõc</label>
                    <input type="range" id="image-scale" min="50" max="200" value="100">
                    <label>Xoay</label>
                    <input type="range" id="image-rotate" min="0" max="360" value="0">
                </div>
            </div>
            <div class="editor-buttons">
                <button class="cancel-btn" onclick="cancelImageEdit()">H·ªßy</button>
                <button onclick="applyImageEdit()">√Åp d·ª•ng</button>
            </div>
        </div>
    </div>

    <script>
        // Tr·∫°ng th√°i cho c√°c h√¨nh ·∫£nh
        const imageStates = {
            top: { hasImage: false },
            front: { hasImage: false },
            back: { hasImage: false },
            left: { hasImage: false },
            right: { hasImage: false }
        };

        // Navigation functions
        function showSelectionPage() {
            document.getElementById('selection-page').style.display = 'block';
            document.getElementById('template-page').style.display = 'none';
            document.getElementById('main-content').style.display = 'none';
        }

        function showTemplates() {
            document.getElementById('selection-page').style.display = 'none';
            document.getElementById('template-page').style.display = 'block';
            document.getElementById('main-content').style.display = 'none';
        }

        function showCustomDesign() {
            document.getElementById('selection-page').style.display = 'none';
            document.getElementById('template-page').style.display = 'none';
            document.getElementById('main-content').style.display = 'block';
            initializeBoxFaces();
        }

        // H√†m kh·ªüi t·∫°o c√°c m·∫∑t h·ªôp
        function initializeBoxFaces() {
            const faces = ['top', 'front', 'back', 'left', 'right'];
            const colors = {
                top: '231, 76, 60',
                front: '52, 152, 219',
                back: '46, 204, 113',
                left: '243, 156, 18',
                right: '155, 89, 182'
            };
            
            faces.forEach(face => {
                const element3d = document.getElementById(`${face}-3d`);
                if (element3d && !imageStates[face].hasImage) {
                    element3d.style.backgroundImage = 'none';
                    element3d.style.backgroundColor = `rgba(${colors[face]}, 0.3)`;
                }
            });
        }

        // X·ª≠ l√Ω upload ·∫£nh
        function handleImageUpload(faceId, file) {
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(event) {
                const img = new Image();
                img.onload = function() {
                    const face3d = document.getElementById(`${faceId}-3d`);
                    if (face3d) {
                        // T·∫°o canvas ƒë·ªÉ resize ·∫£nh
                        const canvas = document.createElement('canvas');
                        const ctx = canvas.getContext('2d');
                        
                        // L·∫•y k√≠ch th∆∞·ªõc th·ª±c t·∫ø c·ªßa m·∫∑t h·ªôp
                        const faceWidth = face3d.offsetWidth;
                        const faceHeight = face3d.offsetHeight;
                        
                        // Set k√≠ch th∆∞·ªõc canvas b·∫±ng v·ªõi k√≠ch th∆∞·ªõc m·∫∑t h·ªôp
                        canvas.width = faceWidth;
                        canvas.height = faceHeight;
                        
                        // T√≠nh to√°n t·ª∑ l·ªá ƒë·ªÉ ·∫£nh v·ª´a v·ªõi m·∫∑t h·ªôp
                        const scale = Math.max(
                            faceWidth / img.width,
                            faceHeight / img.height
                        );
                        
                        // T√≠nh to√°n k√≠ch th∆∞·ªõc m·ªõi c·ªßa ·∫£nh
                        const newWidth = img.width * scale;
                        const newHeight = img.height * scale;
                        
                        // T√≠nh to√°n v·ªã tr√≠ ƒë·ªÉ cƒÉn gi·ªØa ·∫£nh
                        const x = (faceWidth - newWidth) / 2;
                        const y = (faceHeight - newHeight) / 2;
                        
                        // V·∫Ω ·∫£nh ƒë√£ resize l√™n canvas
                        ctx.fillStyle = 'transparent';
                        ctx.fillRect(0, 0, faceWidth, faceHeight);
                        ctx.drawImage(img, x, y, newWidth, newHeight);
                        
                        // Chuy·ªÉn canvas th√†nh URL v√† set l√†m background
                        const resizedImageUrl = canvas.toDataURL('image/png');
                        face3d.style.backgroundImage = `url('${resizedImageUrl}')`;
                        face3d.style.backgroundColor = 'transparent';
                        face3d.style.backgroundSize = 'cover';
                        face3d.style.backgroundPosition = 'center';
                        imageStates[faceId].hasImage = true;
                    }
                };
                img.src = event.target.result;
            };
            reader.readAsDataURL(file);
        }

        // X·ª≠ l√Ω xoay m√¥ h√¨nh 3D
        const box3d = document.getElementById('box-3d-preview');
        let isDragging = false;
        let previousMousePosition = {
            x: 0,
            y: 0
        };
        let rotation = {
            x: -20,
            y: -30
        };

        box3d.addEventListener('mousedown', function(e) {
            isDragging = true;
            previousMousePosition = {
                x: e.clientX,
                y: e.clientY
            };
        });

        document.addEventListener('mousemove', function(e) {
            if (!isDragging) return;

            const deltaMove = {
                x: e.clientX - previousMousePosition.x,
                y: e.clientY - previousMousePosition.y
            };

            rotation.x += deltaMove.y * 0.5;
            rotation.y += deltaMove.x * 0.5;

            box3d.style.transform = `rotateX(${rotation.x}deg) rotateY(${rotation.y}deg)`;

            previousMousePosition = {
                x: e.clientX,
                y: e.clientY
            };
        });

        document.addEventListener('mouseup', function() {
            isDragging = false;
        });

        // X·ª≠ l√Ω cho thi·∫øt b·ªã c·∫£m ·ª©ng
        box3d.addEventListener('touchstart', function(e) {
            isDragging = true;
            previousMousePosition = {
                x: e.touches[0].clientX,
                y: e.touches[0].clientY
            };
        });

        document.addEventListener('touchmove', function(e) {
            if (!isDragging) return;

            const deltaMove = {
                x: e.touches[0].clientX - previousMousePosition.x,
                y: e.touches[0].clientY - previousMousePosition.y
            };

            rotation.x += deltaMove.y * 0.5;
            rotation.y += deltaMove.x * 0.5;

            box3d.style.transform = `rotateX(${rotation.x}deg) rotateY(${rotation.y}deg)`;

            previousMousePosition = {
                x: e.touches[0].clientX,
                y: e.touches[0].clientY
            };
        });

        document.addEventListener('touchend', function() {
            isDragging = false;
        });

        // Kh·ªüi t·∫°o khi trang t·∫£i xong
        document.addEventListener('DOMContentLoaded', function() {
            // X·ª≠ l√Ω chuy·ªÉn tab
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    tabs.forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    
                    document.querySelectorAll('.tab-content').forEach(content => {
                        content.classList.remove('active');
                    });
                    document.getElementById(`${this.dataset.tab}-tab`).classList.add('active');
                });
            });

            // X·ª≠ l√Ω upload ·∫£nh
            document.querySelectorAll('.face-image').forEach(input => {
                input.addEventListener('change', function(e) {
                    const faceId = this.id.split('-')[0];
                    const file = e.target.files[0];
                    if (file) {
                        // Ki·ªÉm tra k√≠ch th∆∞·ªõc v√† lo·∫°i file
                        if (file.type.match('image.*')) {
                            handleImageUpload(faceId, file);
                        } else {
                            alert('Vui l√≤ng ch·ªçn file h√¨nh ·∫£nh!');
                        }
                    }
                });
            });

            // X·ª≠ l√Ω n√∫t c·∫≠p nh·∫≠t
            document.getElementById('update-btn').addEventListener('click', function() {
                const sizeSelect = document.getElementById('box-size');
                if (sizeSelect.value === 'custom') {
                    const width = parseFloat(document.getElementById('box-width').value);
                    const height = parseFloat(document.getElementById('box-height').value);
                    const depth = parseFloat(document.getElementById('box-depth').value);
                    updateBoxSize(width, height, depth);
                } else {
                    const sizes = {
                        small: 10,
                        medium: 15,
                        large: 20
                    };
                    const size = sizes[sizeSelect.value];
                    updateBoxSize(size, size, size);
                }
            });

            // X·ª≠ l√Ω n√∫t l∆∞u
            document.getElementById('save-btn').addEventListener('click', function() {
                alert('Thi·∫øt k·∫ø ƒë√£ ƒë∆∞·ª£c l∆∞u! B·∫°n c√≥ th·ªÉ in ra ho·∫∑c ƒë·∫∑t h√†ng.');
            });

            // Kh·ªüi t·∫°o k√≠ch th∆∞·ªõc m·∫∑c ƒë·ªãnh
            updateBoxSize(15, 15, 15);
        });

        function toggleCustomSize() {
            const sizeSelect = document.getElementById('box-size');
            const customSizeDiv = document.getElementById('custom-size');
            const box3d = document.getElementById('box-3d-preview');
            
            if (sizeSelect.value === 'custom') {
                customSizeDiv.style.display = 'block';
            } else {
                customSizeDiv.style.display = 'none';
                // C·∫≠p nh·∫≠t k√≠ch th∆∞·ªõc theo option ƒë∆∞·ª£c ch·ªçn
                const sizes = {
                    small: 10,
                    medium: 15,
                    large: 20
                };
                const size = sizes[sizeSelect.value];
                updateBoxSize(size, size, size);
            }
        }

        function updateBoxSize(width, height, depth) {
            const box3d = document.getElementById('box-3d-preview');
            const faces = {
                top: document.getElementById('top-3d'),
                front: document.getElementById('front-3d'),
                back: document.getElementById('back-3d'),
                left: document.getElementById('left-3d'),
                right: document.getElementById('right-3d')
            };

            // C·∫≠p nh·∫≠t k√≠ch th∆∞·ªõc c√°c m·∫∑t
            const scale = Math.min(200 / Math.max(width, height, depth), 10);
            const scaledWidth = width * scale;
            const scaledHeight = height * scale;
            const scaledDepth = depth * scale;

            // C·∫≠p nh·∫≠t k√≠ch th∆∞·ªõc v√† v·ªã tr√≠ c√°c m·∫∑t
            faces.front.style.width = `${scaledWidth}px`;
            faces.front.style.height = `${scaledHeight}px`;
            faces.front.style.transform = `translateZ(${scaledDepth/2}px)`;

            faces.back.style.width = `${scaledWidth}px`;
            faces.back.style.height = `${scaledHeight}px`;
            faces.back.style.transform = `rotateY(180deg) translateZ(${scaledDepth/2}px)`;

            faces.left.style.width = `${scaledDepth}px`;
            faces.left.style.height = `${scaledHeight}px`;
            faces.left.style.transform = `rotateY(-90deg) translateZ(${scaledWidth/2}px)`;

            faces.right.style.width = `${scaledDepth}px`;
            faces.right.style.height = `${scaledHeight}px`;
            faces.right.style.transform = `rotateY(90deg) translateZ(${scaledWidth/2}px)`;

            faces.top.style.width = `${scaledWidth}px`;
            faces.top.style.height = `${scaledDepth}px`;
            faces.top.style.transform = `rotateX(90deg) translateZ(${scaledHeight/2}px)`;
        }
    </script>
</body>
</html>
